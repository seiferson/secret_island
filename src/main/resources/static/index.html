<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fomantic-ui/2.7.8/semantic.css">
  <title>Secret Island</title>
</head>
<body>

<div class="ui container">
  <br />
  <br />
  <br />
  <div class="ui basic segment">
    <h1>Secret Island</h1>
    <br />
    <br />
    <br />

    <h2>Journal</h2>
    <div class="ui placeholder" id="feed_placeholder">
      <div class="image header">
        <div class="line"></div>
        <div class="line"></div>
      </div>
      <div class="image header">
        <div class="line"></div>
        <div class="line"></div>
      </div>
      <div class="image header">
        <div class="line"></div>
        <div class="line"></div>
      </div>
      <div class="image header">
        <div class="line"></div>
        <div class="line"></div>
      </div>
    </div>

    <div class="ui feed" id="feed">
    </div>

    <br />
    <br />
    <br />

    <p>Powered by <a href="https://www.heroku.com/">Heroku</a> and <a href="https://www.mongodb.com/">Atlas</a></p>
    <p><a href="https://github.com/seiferson">@seiferson</a>  2022</p>
    <p><a href="/api/v1">API</a></p>
  </div>
</div>

<script>
  fetch('/api/v1/hPosts')
    .then(response => {
      return response.json();
    })
    .then( response => {
      if(response.page.totalElements > 0) {
        document.getElementById('feed_placeholder').remove();
        var feed = document.getElementById('feed');
        response._embedded.hPosts.forEach(hPost => {
          var post = document.createElement("div");
          post.classList.add("event")

          var label = document.createElement("div");
          label.classList.add("label");

          var img = document.createElement('img');
          img.src = "https://avatars.dicebear.com/api/open-peeps/seiferson.svg?head=mohawk&face=blank&skinColor=variant02&hairColor=variant06";

          label.appendChild(img);
          post.appendChild(label);

          var content = document.createElement("div");
          content.classList.add("content");

          var summary = document.createElement("div");
          summary.classList.add("summary");

          var author = document.createElement("a");
          author.classList.add("user");
          author.href = "https://github.com/" + hPost.author;
          var authorText = document.createTextNode("@" + hPost.author);
          author.appendChild(authorText);
          summary.appendChild(author);

          var date =  document.createElement("div");
          date.classList.add("date");
          var dateText = document.createTextNode(hPost.postedDate);
          date.appendChild(dateText);

          summary.appendChild(date);
          content.appendChild(summary);

          var text = document.createElement("div");
          text.classList.add("extra");
          text.classList.add("text");
          var contentText = document.createTextNode(hPost.content);
          text.appendChild(contentText);

          content.appendChild(text);
          post.appendChild(content);
          feed.appendChild(post);
        });
      }
    });
</script>
</body>
</html>